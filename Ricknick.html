<html><head><base href="https://ricknick-chat.example.com/">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ricknick - The Customizable Chat Platform</title>
<link href="https://fonts.googleapis.com/css2?family=Arimo:wght@400;700&display=swap" rel="stylesheet">
<style id="themeStyle">
  :root {
    --bg-primary: #000000;
    --bg-secondary: #080808;
    --bg-tertiary: #101010;
    --text-primary: #ffffff;
    --text-secondary: #e24a4a;
    --accent-color: #9e2d2d;
    --accent-hover: #c73636;
    --input-bg: #1a1a1a;
    --badge-bg: #4a90e2;
  }
  body, html {
    height: 100%;
    margin: 0;
    font-family: 'Arimo', sans-serif;
    background-color: var(--bg-primary);
    color: var(--text-primary);
  }
  .container {
    display: flex;
    height: 100%;
  }
  .sidebar {
    width: 250px;
    background-color: var(--bg-secondary);
    padding: 20px;
    box-sizing: border-box;
    border-right: 1px solid #333;
    display: flex;
    flex-direction: column;
  }
  .main {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    padding: 20px;
    background-color: var(--bg-secondary);
  }
  #chat {
    flex-grow: 1;
    overflow-y: auto;
    margin-bottom: 20px;
    background-color: var(--bg-tertiary);
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
  }
  #messageForm {
    display: flex;
  }
  #messageInput {
    flex-grow: 1;
    padding: 12px;
    border: none;
    border-radius: 20px;
    background-color: var(--input-bg);
    color: var(--text-primary);
    font-size: 14px;
    font-family: 'Arimo', sans-serif;
  }
  button {
    padding: 10px 20px;
    background-color: var(--accent-color);
    color: white;
    border: none;
    border-radius: 20px;
    cursor: pointer;
    margin-left: 10px;
    transition: background-color 0.3s ease;
    font-family: 'Arimo', sans-serif;
  }
  button:hover {
    background-color: var(--accent-hover);
  }
  .message {
    margin-bottom: 15px;
    padding: 10px;
    background-color: var(--bg-secondary);
    border-radius: 8px;
  }
  .username {
    font-weight: bold;
    color: var(--text-secondary);
    margin-right: 8px;
  }
  .badge {
    display: inline-block;
    background-color: var(--badge-bg);
    color: white;
    font-size: 12px;
    padding: 2px 6px;
    border-radius: 10px;
    margin-left: 5px;
    cursor: help;
  }
  h2 {
    color: var(--text-secondary);
    font-size: 24px;
    margin-bottom: 20px;
  }
  input[type="text"], select {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: none;
    border-radius: 4px;
    background-color: var(--input-bg);
    color: var(--text-primary);
    font-family: 'Arimo', sans-serif;
  }
  #settingsMenu {
    margin-top: auto;
  }
  .hidden {
    display: none;
  }
  #settingsButton {
    margin-top: auto;
    margin-bottom: 10px;
  }
  #sourceCodeLink {
    color: var(--text-secondary);
    text-decoration: none;
    display: inline-block;
    margin-top: 10px;
  }
  #sourceCodeLink:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>
<div class="container">
  <div class="sidebar">
    <h2>Ricknick</h2>
    <p>1. Server, 1. Username</p>
    <div id="userInfo">
      <p>Current Username: <span id="currentUsername"></span></p>
    </div>
    <button id="settingsButton" onclick="toggleSettings()">Settings</button>
    <div id="settingsMenu" class="hidden">
      <h3>Settings</h3>
      <label for="usernameInput">Change Username:</label>
      <input type="text" id="usernameInput" placeholder="Enter new username">
      <button onclick="changeUsername()">Update Username</button>
      <label for="themeSelect">Select Theme:</label>
      <select id="themeSelect" onchange="changeTheme()">
        <option value="darkMode">Dark Mode</option>
        <option value="pitchBlack">Pitch Black</option>
        <option value="midnightRed">Midnight Red</option>
        <option value="darkGray">Dark Gray</option>
      </select>
      <a id="sourceCodeLink" href="https://github.com/SDHL-Scyda/Ricknick" target="_blank">Source Code</a>
    </div>
  </div>
  <div class="main">
    <div id="chat"></div>
    <form id="messageForm">
      <input type="text" id="messageInput" placeholder="Type your message..." required>
      <button type="submit">Send</button>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
<script>
  const gun = Gun(['https://gun-manhattan.herokuapp.com/gun']);
  const chat = gun.get('ricknick-chat-customizable');

  let currentUsername = localStorage.getItem('username') || '';
  let currentTheme = localStorage.getItem('theme') || 'pitchBlack';

  const themes = {
    darkMode: {
      '--bg-primary': '#0a0a0a',
      '--bg-secondary': '#121212',
      '--bg-tertiary': '#1e1e1e',
      '--text-primary': '#e0e0e0',
      '--text-secondary': '#e24a4a',
      '--accent-color': '#9e2d2d',
      '--accent-hover': '#c73636',
      '--input-bg': '#2a2a2a',
      '--badge-bg': '#4a90e2'
    },
    pitchBlack: {
      '--bg-primary': '#000000',
      '--bg-secondary': '#080808',
      '--bg-tertiary': '#101010',
      '--text-primary': '#ffffff',
      '--text-secondary': '#e24a4a',
      '--accent-color': '#9e2d2d',
      '--accent-hover': '#c73636',
      '--input-bg': '#1a1a1a',
      '--badge-bg': '#4a90e2'
    },
    midnightRed: {
      '--bg-primary': '#1a0a0a',
      '--bg-secondary': '#1e1212',
      '--bg-tertiary': '#2a1e1e',
      '--text-primary': '#e0e0e0',
      '--text-secondary': '#e24a4a',
      '--accent-color': '#9e2d2d',
      '--accent-hover': '#c73636',
      '--input-bg': '#3a2a2a',
      '--badge-bg': '#4a90e2'
    },
    darkGray: {
      '--bg-primary': '#1a1a1a',
      '--bg-secondary': '#222222',
      '--bg-tertiary': '#2a2a2a',
      '--text-primary': '#e0e0e0',
      '--text-secondary': '#e24a4a',
      '--accent-color': '#9e2d2d',
      '--accent-hover': '#c73636',
      '--input-bg': '#3a3a3a',
      '--badge-bg': '#4a90e2'
    }
  };

  function updateUI() {
    document.getElementById('currentUsername').textContent = currentUsername;
    document.getElementById('themeSelect').value = currentTheme;
  }

  function changeUsername() {
    const newUsername = document.getElementById('usernameInput').value.trim();
    if (newUsername) {
      currentUsername = newUsername;
      localStorage.setItem('username', currentUsername);
      updateUI();
      alert(`Username updated to: ${currentUsername}`);
    }
  }

  function changeTheme() {
    currentTheme = document.getElementById('themeSelect').value;
    localStorage.setItem('theme', currentTheme);
    applyTheme();
  }

  function applyTheme() {
    const root = document.documentElement;
    const themeColors = themes[currentTheme];
    if (themeColors) {
      for (const [property, value] of Object.entries(themeColors)) {
        root.style.setProperty(property, value);
      }
    }
  }

  function toggleSettings() {
    const settingsMenu = document.getElementById('settingsMenu');
    settingsMenu.classList.toggle('hidden');
  }

  function displayMessage(message) {
    const chatDiv = document.getElementById('chat');
    const messageElement = document.createElement('div');
    messageElement.classList.add('message');
    let badgeHTML = '';
    if (message.username === 'Human') {
      badgeHTML = '<span class="badge" title="Founder">F</span>';
    }
    messageElement.innerHTML = `<span class="username">${message.username}${badgeHTML}:</span> ${message.text}`;
    chatDiv.appendChild(messageElement);
    chatDiv.scrollTop = chatDiv.scrollHeight;
  }

  chat.map().on(function(message, id) {
    if (message && message.username && message.text) {
      displayMessage(message);
    }
  });

  document.getElementById('messageForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const messageInput = document.getElementById('messageInput');
    const message = messageInput.value.trim();
    if (message && currentUsername) {
      chat.set({
        username: currentUsername,
        text: message,
        timestamp: Date.now()
      });
      messageInput.value = '';
    } else if (!currentUsername) {
      alert('Please set a username in the settings menu!');
    }
  });

  // Initialize
  updateUI();
  applyTheme();

  // If username is not set, show an alert
  if (!currentUsername) {
    alert('Please set your username in the settings menu to start chatting!');
  }
</script>
</body>
</html>
